[
  {
    "canonical_name": "normalize_identifiers",
    "functions": [
      "activity.ChemblActivityPipeline._normalize_identifiers",
      "assay.ChemblAssayPipeline._normalize_identifiers",
      "target.ChemblTargetPipeline._normalize_identifiers",
      "testitem.TestItemChemblPipeline._normalize_identifiers"
    ],
    "delta_signature": "одинаковые аргументы (self, df, log)",
    "recommendation": "Вынести в bioetl/pipelines/common/identifiers.py с параметром kind",
    "risk": "medium"
  },
  {
    "canonical_name": "ensure_schema_columns",
    "functions": [
      "PipelineBase._ensure_schema_columns",
      "ChemblActivityPipeline._ensure_schema_columns",
      "ChemblTargetPipeline._ensure_schema_columns",
      "TestItemChemblPipeline._ensure_schema_columns"
    ],
    "delta_signature": "у наследников добавлены доменные проверки",
    "recommendation": "Оставить общий каркас в базовом классе, доменные дополнения через хуки",
    "risk": "low"
  },
  {
    "canonical_name": "enrichment_stages",
    "functions": [
      "activity_enrichment.enrich_with_assay",
      "activity_enrichment.enrich_with_compound_record",
      "assay_enrichment.enrich_with_assay_classifications",
      "assay_enrichment.enrich_with_assay_parameters",
      "document_enrich.enrich_with_document_terms"
    ],
    "delta_signature": "общая сигнатура (df, client, cfg), но разная постобработка",
    "recommendation": "Создать фабрику обогащений common/enrichment.py",
    "risk": "medium"
  },
  {
    "canonical_name": "serialize_arrays",
    "functions": [
      "assay_transform.serialize_array_fields",
      "target_transform.serialize_target_arrays",
      "testitem_transform.serialize_objects",
      "testitem_transform.serialize_simple_list"
    ],
    "delta_signature": "разные параметры columns/config",
    "recommendation": "Единый сериализатор common/serialization.py",
    "risk": "low"
  },
  {
    "canonical_name": "normalize_string_fields",
    "functions": [
      "ChemblActivityPipeline._normalize_string_fields",
      "ChemblAssayPipeline._normalize_string_fields",
      "ChemblTargetPipeline._normalize_string_fields",
      "TestItemChemblPipeline._normalize_string_fields",
      "ChemblDocumentPipeline._normalize_string_fields"
    ],
    "delta_signature": "совпадающие аргументы (self, df, log)",
    "recommendation": "Вынести в общий миксин строковой нормализации",
    "risk": "low"
  },
  {
    "canonical_name": "normalize_data_types",
    "functions": [
      "PipelineBase._normalize_data_types",
      "ChemblActivityPipeline._normalize_data_types",
      "ChemblAssayPipeline._normalize_data_types",
      "ChemblTargetPipeline._normalize_data_types"
    ],
    "delta_signature": "доменные версии добавляют спец-кастинг",
    "recommendation": "Регистрация dtype-конвертеров по схеме",
    "risk": "medium"
  },
  {
    "canonical_name": "extract_paginated",
    "functions": [
      "ChemblPipelineBase.extract_ids_paginated",
      "ChemblActivityPipeline._extract_from_chembl"
    ],
    "delta_signature": "activity добавляет кэш и fallback",
    "recommendation": "Расширить базовый метод параметрами TTL/cache",
    "risk": "high"
  }
]