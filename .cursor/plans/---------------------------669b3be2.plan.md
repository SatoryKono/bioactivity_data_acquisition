<!-- 669b3be2-d568-4117-b511-77340391b964 f10ddf6f-3706-4874-9c9f-8fe7321e0345 -->

# Документация конфигурационных файлов и схемы данных
## Обзор
Для каждого из 5 конфигов v2 добавить подробные комментарии к параметрам и создать документацию схемы данных с описанием источников, типов и критериев валидации для всех колонок из `column_order`.

## Структура работы
### 1. Расширение конфигов с описаниями параметров
Для каждого конфига (`config_activities_v2.yaml`, `config_assays_v2.yaml`, `config_documents_v2.yaml`, `config_targets_v2.yaml`, `config_testitems_v2.yaml`):

- **Параметры верхнего уровня**: добавить комментарии к блокам `pipeline`, `http`, `sources`, `io`, `runtime`, `logging`, `determinism`, `validation`, `postprocess`, `normalization`, `quality`, `cache`, `telemetry`
- **Колонки в column_order**: для каждой колонки добавить inline-комментарий с:
- Описание поля
- Источник (БД + эндпоинт/таблица)
- Тип данных (STRING, INT, DECIMAL, TEXT, BOOL, JSON)
- Критерии валидации (паттерны, диапазоны, NOT NULL, UNIQUE)

### 2. Создание документации схемы данных
Создать файл `docs/reference/data_schema.md` со следующей структурой:

- **Введение**: описание звездной схемы (facts + dimensions)
- **Для каждого пайплайна** (Documents, Targets, Assays, Testitems, Activities):
- Список источников данных с эндпоинтами и параметрами
- Извлекаемые сырые поля по каждому источнику
- Нормализованные поля итоговой таблицы
- Детальная таблица с колонками:
- Название поля
- Описание
- Источник (API endpoint)
- Тип данных (SQL-подобный)
- Ограничения (NOT NULL, UNIQUE, CHECK, FK)
- Единицы измерения (где применимо)
- Справочники

### 3. Обновление schema.json
Расширить `configs/schema.json` с добавлением:

- Метаданных для каждой таблицы (description, sources)
- Детальных описаний полей с типами, constraints, units
- JSON Schema валидаций согласно критериям из инвентаризации

## Детали реализации
**Activities** (activity_fact):

- Источник: ChEMBL `/activity` API
- ~25 колонок: идентификаторы (activity_chembl_id, assay_chembl_id, molecule_chembl_id, target_chembl_id, document_chembl_id), published/standard values, pchembl_value, BAO аннотации
- Валидация: activity_chembl_id PK, standard_value ≥ 0, standard_units из справочника

**Assays** (assay_dim):

- Источник: ChEMBL `/assay` API
- ~20 колонок: assay_chembl_id, assay_type, target_chembl_id, organism/cell/tissue, BAO classifications
- Валидация: PK assay_chembl_id, FK target_chembl_id, confidence_score 0-1

**Documents** (document_dim):

- Источники: ChEMBL, Crossref, OpenAlex, PubMed, Semantic Scholar
- ~90 колонок: сгруппированные по источникам (pmid, title, abstract, authors, doi, journal, year, volume, issue, pages), + valid_* и publication_date
- Валидация: document_chembl_id PK, doi/pmid UNIQUE, year 1900-текущий

**Targets** (target_dim):

- Источники: ChEMBL, UniProt, IUPHAR/GtoP, HGNC
- ~65+ колонок из реального output файла:
- **ChEMBL**: target_chembl_id (PK), pref_name, target_type, tax_id, species_group_flag, target_components, protein_classifications, cross_references, reaction_ec_numbers
- **UniProt**: uniprot_id_primary, uniProtkbId, secondaryAccessions, recommendedName, protein_name_alt, geneName, gene_symbol_list, organism, taxon_id, lineage (superkingdom/phylum/class), sequence_length, molecular_function, cellular_component, subcellular_location, topology, transmembrane, intramembrane, glycosylation, lipidation, disulfide_bond, modified_residue, phosphorylation, acetylation, ubiquitination, signal_peptide, propeptide, xref (ensembl/pdb/alphafold), family, SUPFAM, PROSITE, InterPro, Pfam, PRINTS, TCDB, GuidetoPHARMACOLOGY, reactions, isoform (ids/names/synonyms), uniprot_last_update, uniprot_version
- **IUPHAR/GtoP**: iuphar_target_id, iuphar_family_id, iuphar_type, iuphar_class, iuphar_subclass, iuphar_chain, iuphar_name, iuphar_full_id_path, iuphar_full_name_path, gtop_target_id, gtop_synonyms, gtop_natural_ligands_n, gtop_interactions_n, gtop_function_text_short
- **HGNC**: hgnc_name, hgnc_id
- **Метаданные**: pipeline_version, timestamp_utc
- Валидация: target_chembl_id PK (^CHEMBL\d+$), uniprot_id_primary UNIQUE (UniProt format), tax_id > 0, sequence_length > 0

**Testitems** (testitem_dim):

- Источники: ChEMBL `/molecule`, PubChem PUG-REST
- ~70+ колонок из реального output файла:
- **ChEMBL основные**: molecule_chembl_id (PK), molregno, pref_name, pref_name_key, parent_chembl_id, parent_molregno, max_phase, therapeutic_flag, dosed_ingredient, first_approval, structure_type, molecule_type
- **ChEMBL физхим**: mw_freebase, alogp, hba, hbd, psa, rtb, ro3_pass, num_ro5_violations, acd_most_apka, acd_most_bpka, acd_logp, acd_logd, molecular_species, full_mwt, aromatic_rings, heavy_atoms, qed_weighted, mw_monoisotopic, full_molformula, hba_lipinski, hbd_lipinski, num_lipinski_ro5_violations
- **ChEMBL пути введения**: oral, parenteral, topical
- **ChEMBL флаги**: black_box_warning, natural_product, first_in_class, chirality, prodrug, inorganic_flag, polymer_flag
- **ChEMBL регистрация**: usan_year, availability_type, usan_stem, usan_substem, usan_stem_definition, indication_class
- **ChEMBL отзыв**: withdrawn_flag, withdrawn_year, withdrawn_country, withdrawn_reason
- **ChEMBL механизм**: mechanism_of_action, direct_interaction, molecular_mechanism
- **ChEMBL drug**: drug_chembl_id, drug_name, drug_type, drug_substance_flag, drug_indication_flag, drug_antibacterial_flag, drug_antiviral_flag, drug_antifungal_flag, drug_antiparasitic_flag, drug_antineoplastic_flag, drug_immunosuppressant_flag, drug_antiinflammatory_flag
- **PubChem**: pubchem_cid, pubchem_molecular_formula, pubchem_molecular_weight, pubchem_canonical_smiles, pubchem_isomeric_smiles, pubchem_inchi, pubchem_inchi_key, pubchem_registry_id, pubchem_rn
- **Стандартизация**: standardized_inchi, standardized_inchi_key, standardized_smiles
- **Метаданные**: index, source_system, chembl_release, extracted_at, hash_row, hash_business_key
- Валидация: molecule_chembl_id PK (^CHEMBL\d+$), mw_freebase/full_mwt 50-2000, num_ro5_violations 0-5, max_phase 0-4, standardized_inchi_key формат InChIKey

## Итоговые артефакты
1. 5 обновленных YAML конфигов с подробными комментариями
2. `docs/reference/data_schema.md` — полное описание схемы данных
3. Обновленный `configs/schema.json` с расширенными метаданными

### To-dos
- [ ] Добавить описания параметров и колонок в config_activities_v2.yaml
- [ ] Добавить описания параметров и колонок в config_assays_v2.yaml
- [ ] Добавить описания параметров и колонок в config_documents_v2.yaml
- [ ] Добавить описания параметров и колонок в config_targets_v2.yaml
- [ ] Добавить описания параметров и колонок в config_testitems_v2.yaml
- [ ] Создать docs/reference/data_schema.md с полной документацией схемы данных
- [ ] Расширить configs/schema.json с детальными метаданными
