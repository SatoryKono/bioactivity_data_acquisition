---
description: Базовые инварианты проекта — детерминизм, стабильные контракты, явные изменения
alwaysApply: true
tags: [core, determinism, contracts]
version: "1.0.0"
---

# context
Применяется ко всему проекту. Обеспечивает общие правила поведения агента.

# requirements
- ДОЛЖЕН обеспечивать детерминизм артефактов: фиксированный порядок колонок/строк, UTC-время, каноническая сериализация.
- ДОЛЖЕН использовать атомарную запись (temp → os.replace) для файлов с данными/артефактами.
- НЕЛЬЗЯ вносить silent-изменения публичных API/CLI/схем. Любой breaking change сопровождается миграционной заметкой и изменением версий.
- ДОЛЖЕН объяснять план действий, перечислять изменяемые файлы и показывать диффы при модификациях.

# examples
## valid
```py
tmp = path.with_suffix(".tmp")
tmp.write_text(payload, encoding="utf-8")
os.replace(tmp, path)
```

## invalid
```py
# теряем атомарность и порядок
path.write_text(payload, encoding="utf-8")
```
