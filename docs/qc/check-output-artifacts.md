# bioetl-check-output-artifacts

Утилита проверяет артефакты в `data/output` и помогает вынести крупные файлы во внешнее хранилище или архив.

## Поведение

- Использует `UnifiedLogger` и фиксирует `run_id`, рабочий каталог и параметры запуска.
- Сканирует `data/output` рекурсивно, обходя файлы, игнорируемые Git (`.gitignore` + `data/.gitignore`).
- Для каждого файла вычисляет размер в байтах и сравнивает с лимитом.
- При обнаружении превышений печатает детализированный отчёт в STDOUT и завершает работу кодом `1`.
- Если нарушений нет, завершает работу кодом `0` без дополнительных сообщений.

## Параметры и значения по умолчанию

- `--max-bytes INTEGER` — верхняя граница размера файла. Значение по умолчанию хранится в `MAX_BYTES = 1_000_000` (1 MB) в `src/bioetl/tools/check_output_artifacts.py`.
- Все параметры передаются через Typer-CLI (`src/bioetl/cli/tools/check_output_artifacts.py`) и валидируются до запуска проверки.

## Пример запуска

```bash
bioetl-check-output-artifacts --max-bytes 2000000
```

Команда возвращает код `1`, если найден хотя бы один файл больше указанного порога. В противном случае код возврата `0`.

## Проверка и тестирование

- `tests/bioetl/cli/test_check_output_artifacts.py` покрывает сценарии с превышением порога и отсутствие нарушений.
- Тесты подтверждают ненулевой код выхода при нарушении лимита.

## Источники реализации

- Основная логика: `src/bioetl/tools/check_output_artifacts.py`.
- CLI-обёртка: `src/bioetl/cli/tools/check_output_artifacts.py`.

## Риски и рекомендации

- Не дублируйте параметры или значения порога в других документах — источником правды остаётся модуль `check_output_artifacts.py`.
- При изменении лимита или поведения обновляйте тесты и данную страницу.


