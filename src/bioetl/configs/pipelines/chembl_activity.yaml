extends:
  - ../base.yaml
  - ../includes/determinism.yaml
  - ../includes/chembl_source.yaml

pipeline:
  name: activity
  entity: activity
  version: "1.0.0"

materialization:
  pipeline_subdir: "activity"

sources:
  chembl:
    enabled: true
    batch_size: 20
    max_url_length: 2000
    headers:
      User-Agent: "bioetl-activity-pipeline/1.0"

determinism:
  sort:
    by: ["assay_id", "testitem_id", "activity_id"]
    ascending: [true, true, true]
  column_order:
    - "index"
    - "hash_row"
    - "hash_business_key"
    - "pipeline_version"
    - "run_id"
    - "source_system"
    - "chembl_release"
    - "extracted_at"

    - "activity_chembl_id"
    - "assay_chembl_id"
    - "document_chembl_id"
    - "target_chembl_id"
    - "testitem_chembl_id"
    
    - "record_id"
    - "standard_type"
    - "standard_relation"
    - "standard_value"
    - "standard_units"
    - "pchembl_value"
    - "data_validity_comment"

qc:
  enabled: true
  severity_threshold: error
  duplicate_check:
    enabled: true
    field: "activity_id"
    threshold: 0
  thresholds:
    duplicates: 0
    null_rate_critical: 0.3
    invalid_units: 0

