# configs/defaults/base.yaml
#
# Единый профиль по умолчанию для всех пайплайнов BioETL. Использует YAML merge-key
# и якорь `*profile_common`, чтобы минимизировать дублирование в конфигурациях
# конкретных пайплайнов.

extends:
  - ./determinism.yaml
  - ./logging.yaml
  - ./output.yaml

<<: &profile_common
  version: 1

  runtime:
    parallelism: 4
    chunk_rows: 100000
    dry_run: false
    seed: 42

  io:
    input:
      format: csv
      encoding: utf-8
      header: true
      path: null

  http:
    default:
      timeout_sec: 60.0
      connect_timeout_sec: 15.0
      read_timeout_sec: 60.0
      retries:
        total: 5
        backoff_multiplier: 2.0
        backoff_max: 60.0
        statuses: [408, 429, 500, 502, 503, 504]
      rate_limit:
        max_calls: 10
        period: 1.0
      rate_limit_jitter: true
      headers:
        user_agent: "BioETL/1.0 (UnifiedAPIClient)"
        accept: "application/json"
        accept_encoding: "gzip, deflate"

  cache:
    enabled: true
    directory: http_cache
    ttl: 86400

  paths:
    input_root: data/input
    output_root: data/output
    samples_root: data/samples
    remote_output_root: s3://bioactivity-data-lake/output
    cache_root: .cache

  fallbacks:
    enabled: true

  validation:
    strict: true
    coerce: true

  telemetry:
    enabled: true
    exporter: jaeger
    endpoint: null
    sampling_ratio: 1.0
